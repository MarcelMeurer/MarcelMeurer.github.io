<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>ITProCloud Blog</title>
    <description>Welcome to my blog. I'm writing this blog to share my experiences mainly in IT focused on Microsoft Azure. The blog is part of the ITProCloud GmbH.</description>
    <link>https://blog.itprocloud.de/</link>
    <atom:link href="https://blog.itprocloud.de/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Wed, 13 Oct 2021 19:42:58 +0200</pubDate>
    <lastBuildDate>Wed, 13 Oct 2021 19:42:58 +0200</lastBuildDate>
    <generator>Jekyll v4.2.0</generator>
    
      <item>
        <title>WVDAdmin - A native administration Gui for Azure Virtual Desktop (AVD) / Windows Virtual Desktop (WVD)</title>
        <description>&lt;h1 id=&quot;azure-windows-virtual-desktop-administration-with-wvdadmin&quot;&gt;Azure Windows Virtual Desktop administration with WVDAdmin&lt;/h1&gt;
&lt;p&gt;Azure (Windows) Virtual Desktop is generally available under continuous improvement and currently available in the ARM (Spring) and in the Classic (Fall) version. The ARM version is completely into the Azure Portal.  Sometimes it helps to have a native GUI to make some configuration and - for me, most important - to have an easy image handling to deploy session hosts based on a template VM (golden image approach). Therefore I build a native Windows application to do this, and I’m happy to share it with the community.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;../assets/files/WVDAdmin.msi&quot;&gt;&lt;img src=&quot;../assets/icons/download.png&quot; alt=&quot;Download&quot; /&gt; &lt;strong&gt;Download the latest release from 09/30/2021&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The current version supports a lot of configuration and administration capabilities, and I’m continuously improving WVDAdmin. Some features:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Imaging
&lt;ul&gt;
&lt;li&gt;Create images from golden masters (without destroying the master)&lt;/li&gt;
&lt;li&gt;Handle sysprep and modern app&lt;/li&gt;
&lt;li&gt;Clean-up&lt;/li&gt;
&lt;li&gt;Use of shared image gallery definitions&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Rollout
&lt;ul&gt;
&lt;li&gt;Rollout of multiple session hosts&lt;/li&gt;
&lt;li&gt;Store some base settings encrypted for reuse (domain join name, password, …)&lt;/li&gt;
&lt;li&gt;Select VM type for each rollout (is not fixed to the host pool)&lt;/li&gt;
&lt;li&gt;Use of ephemeral disks&lt;/li&gt;
&lt;li&gt;Support of a second partition from the master VM (D:)&lt;/li&gt;
&lt;li&gt;Azure Monitor&lt;/li&gt;
&lt;li&gt;AAD only, join to MEM/intune&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;AVD Support
&lt;ul&gt;
&lt;li&gt;Classic AVD&lt;/li&gt;
&lt;li&gt;ARM AVD (Spring Update)&lt;/li&gt;
&lt;li&gt;Migration of resources and session hosts&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Working with AVD resources
&lt;ul&gt;
&lt;li&gt;Add/create/delete
&lt;ul&gt;
&lt;li&gt;Host Pools&lt;/li&gt;
&lt;li&gt;Application groups&lt;/li&gt;
&lt;li&gt;Workspaces&lt;/li&gt;
&lt;li&gt;Session hosts&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Working with user sessions
&lt;ul&gt;
&lt;li&gt;Disconnect&lt;/li&gt;
&lt;li&gt;Logoff&lt;/li&gt;
&lt;li&gt;Send message&lt;/li&gt;
&lt;li&gt;Shadow&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Session hosts
&lt;ul&gt;
&lt;li&gt;Move between host pools&lt;/li&gt;
&lt;li&gt;Start/Stop/Restart&lt;/li&gt;
&lt;li&gt;Delete - with VM, disk, and nic&lt;/li&gt;
&lt;li&gt;Get error report from AVD agent&lt;/li&gt;
&lt;li&gt;Run scripts remotely on hosts (trigger Windows updates, enable RDP Shortpath, …)&lt;/li&gt;
&lt;li&gt;Change drain-mode&lt;/li&gt;
&lt;li&gt;Change disk type, e.g.: on-start -&amp;gt; to Premium, after deallocation -&amp;gt; to HDD(for cost savings)&lt;/li&gt;
&lt;li&gt;Remove user assignment&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Virtual machine
&lt;ul&gt;
&lt;li&gt;List all VMs with power state in all subscriptions&lt;/li&gt;
&lt;li&gt;Start/Stop/Restart&lt;/li&gt;
&lt;li&gt;Run scripts remotely on hosts (trigger Windows updates, enable RDP Shortpath, …)&lt;/li&gt;
&lt;li&gt;Shrink disk to 64 or 32 GByte (to create small images for ephemeral hosts)&lt;/li&gt;
&lt;li&gt;Change disk type, e.g.: on-start -&amp;gt; to premium, after deallocation -&amp;gt; to HDD (for cost savings)&lt;/li&gt;
&lt;li&gt;Create and restore snapshots with a click&lt;/li&gt;
&lt;li&gt;Add an existing domain-joined VM as a session host&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Others
&lt;ul&gt;
&lt;li&gt;Multi-Tenant switch&lt;/li&gt;
&lt;li&gt;Split-Tenant mode&lt;/li&gt;
&lt;li&gt;Search for unused disks and nics&lt;/li&gt;
&lt;li&gt;Rollout VM Scale Sets&lt;/li&gt;
&lt;li&gt;Start and deallocate Scale Set instances&lt;/li&gt;
&lt;li&gt;Re-image Scale Set instances&lt;/li&gt;
&lt;li&gt;Remove customer-managed key (CMK)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;…&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;installation&quot;&gt;Installation&lt;/h1&gt;
&lt;h2 id=&quot;release-history&quot;&gt;Release History&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;../assets/files/WVDAdmin.msi&quot;&gt;&lt;img src=&quot;../assets/icons/download.png&quot; alt=&quot;Download&quot; /&gt; &lt;strong&gt;Download the latest release from 09/30/2021&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;details&gt;&lt;summary&gt;I'm continuously updating WVDAdmin to make it easier to administrate and deploy WVD, users, and session hosts. Click to see the change history.&lt;/summary&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Release&lt;/th&gt;
&lt;th&gt;Changes &amp;amp; Notes&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1.7.17.0&lt;/td&gt;
&lt;td&gt;Change: The API permission for Azure AD Graph is no longer needed for the service principal if you are using WVDAdmin for AVD (spring edition)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.7.16.0&lt;/td&gt;
&lt;td&gt;Add: Session host rollout will set an additional tag to VM, Nic and Disk: WVD.Host=&lt;Name of session host&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.7.15.0&lt;/td&gt;
&lt;td&gt;Fix: If you deallocate a VM without tags, the VM is deallocate but an error message is/was shown (Changing power state of Azure vm was not successful Object reference not set to an instance of an object.)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.7.14.0&lt;/td&gt;
&lt;td&gt;Change: Uninstallation of th RDAgent (if you capture a session host is now faster)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.7.13.0&lt;/td&gt;
&lt;td&gt;Add: Join MEM/Intune while rolling out session hosts; Add: Function to shrink a disk of a VM to 32 GByte to rollout cheaper instances and/or use smaller instances with ephemeral disks&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.7.11.0&lt;/td&gt;
&lt;td&gt;Add: Optimization to capture a session host for a new image&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.7.09.0&lt;/td&gt;
&lt;td&gt;Change: Change the rollout process to be more reliable if you deploy a lot of hosts at once; Fix: Secrets can now have special characters&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.7.05.0&lt;/td&gt;
&lt;td&gt;Fix: The windows can now be resized to full-screen&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.7.01.0&lt;/td&gt;
&lt;td&gt;Add: Support to show subscription name in rollout and imaging tab (set HKEY_CURRENT_USER\SOFTWARE\ITProCloud\WVDAdmin\ShowSubscriptionName to (reg-dword))&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.7.00.0&lt;/td&gt;
&lt;td&gt;Add: Support to deploy AAD-only session hosts; Fix: Resize of V2 VM disks&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&quot;../assets/files/WVDAdmin_1.6.99.0.msi&quot;&gt;1.6.99.0&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Add: Meta-data location for Canada and the UK&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.98.0&lt;/td&gt;
&lt;td&gt;Fix: Resize the application window height in case you have a smaller resolution (&amp;lt;828 px)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.97.0&lt;/td&gt;
&lt;td&gt;Add: Remove a Customer Managed Key (CMK) from a VM / Disk&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.96.0&lt;/td&gt;
&lt;td&gt;Add: Support for the Edv4- and Edsv4-Serie&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.95.0&lt;/td&gt;
&lt;td&gt;Add: You can now use CTRL+C in each table to copy the content of the selected column&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.94.0&lt;/td&gt;
&lt;td&gt;Fix: An import of the registry settings failed if the windows decryption key is other than the user who exported the settings&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.92.0&lt;/td&gt;
&lt;td&gt;Fix: A session host could be visible in the session host tab of anonter hostpool if the resource id of the host pools starts with the same string&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.91.0&lt;/td&gt;
&lt;td&gt;Add: Create and restore snapshots of a VM (right click the VM in the Azure node)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.90.0&lt;/td&gt;
&lt;td&gt;Add: Function to shrink a disk of a VM to 64 GByte to rollout cheaper instances and/or use smaller instances with ephemeral disks&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.89.0&lt;/td&gt;
&lt;td&gt;Add: Workaround to fix an issue in the Azure API querying VM. In subscriptions with a lot of VMs an error message could given back from the API which will be workaround with this version. Original error message from Azure: Resource provider ‘Microsoft.Compute’ failed to return collection response for type ‘virtualMachines’&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.88.0&lt;/td&gt;
&lt;td&gt;Add: Option to rollout virtual machines based on an image without joining to WVD/AVD (for servers, new golden masters, …), Update: Newest PowerShell script for generalizing and deployment to 3.0: &lt;a href=&quot;https://blog.itprocloud.de/assets/files/AutoUpdate/Scripts/ITPC-WVD-Image-Processing.ps1.txt&quot;&gt;ITPC-WVD-Image-Processing.ps1&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.87.0&lt;/td&gt;
&lt;td&gt;Add: Option to switch on “Power on connect” for pooled (and assigned) host pools (preview feature)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.86.0&lt;/td&gt;
&lt;td&gt;Add: Option to directly roll-out new session hosts with actice Azure Disk Encryption (ADE) - See “secret features” below&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.83.0&lt;/td&gt;
&lt;td&gt;Fix: Update of ITPC-WVD-Image-Processing.ps1 - if you run it from a share with prepared MSIs, the MSIs are ignored and downloaded directly from Microsoft&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.82.0&lt;/td&gt;
&lt;td&gt;Add: Script to enable screen capture protection per session host&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.81.0&lt;/td&gt;
&lt;td&gt;Add: Localized time for the session list (WVD classic)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.80.0&lt;/td&gt;
&lt;td&gt;Add: Message box before logging users off&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.79.0&lt;/td&gt;
&lt;td&gt;Add: VM list in the “Virtual Machines” node are now showing the private IP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.77.0&lt;/td&gt;
&lt;td&gt;Add: Official support for meta-data regions: West Europe and North Europe&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.76.0&lt;/td&gt;
&lt;td&gt;Fix: New applications failed to create in an existing application group&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.75.0&lt;/td&gt;
&lt;td&gt;Fix: In some cases session hosts are not displayed in the session hosts node (no matching resource id - upper-case / lower-case issue)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.73.0&lt;/td&gt;
&lt;td&gt;Add: Automatically change the disk type on start/stop: Add a tag “&lt;a href=&quot;../Changing-the-disk-type-automatically-while-starting-or-deallocating-a-session-host,-VM-for-WVD&quot;&gt;WVD.AdvDiskType&lt;/a&gt;” to a VM with the value “StandardSSD_LRS” or “Premium_LRS”. On the stop, the disk is converted to HDD (lowes costs), and on start, the disk is converted to the named type.  Works only with WVDAdmin (not from the Azure Portal or scaling solutions)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.72.0&lt;/td&gt;
&lt;td&gt;Add: Fix for a sysprep failure (Sysprep data was marked corrupt; cannot proceed) in the ITPC-WVD-Image-Processing.ps1 script; Add: Better handling for shutdown/start/delete VM tasks in the Virtual Machines node&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.71.0&lt;/td&gt;
&lt;td&gt;Add: The disk size for new session hosts can be selected (optional) to have a higher IOPS performance&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.70.0&lt;/td&gt;
&lt;td&gt;Add: For preview only: Checkbox to enable upcoming “Start on connect feature”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.69.0&lt;/td&gt;
&lt;td&gt;Fix: Open files are not shown if different storage accounts in different subscriptions are used under some circumstances&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.68.0&lt;/td&gt;
&lt;td&gt;Add: West Europe as metadata location (can only be used if the subscription is in an appropriate preview program); Add: Some scroll bars to list boxes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.66.0&lt;/td&gt;
&lt;td&gt;Fix: Rollout from session hosts based on a share image gallery item failed in another subscription then the subscription containing the gallery image&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.65.0&lt;/td&gt;
&lt;td&gt;Add: Security query before hosts are started, stopped or restarted&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.64.0&lt;/td&gt;
&lt;td&gt;Add: Install session host optionally with Azure Monitor Extension or sepago Azure Monitor (for Azure Monitor Extension: Make sure that you have configured the target host pool correctly once: Right-click -&amp;gt; Configure Diagnostic settings)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.62.0&lt;/td&gt;
&lt;td&gt;Add: You can now terminate file handles to an Azure Storage (orphaned handles avoiding a user to log in with its FSLogix profile) - Service Principal needs contributor permissions to the storage account&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.61.0&lt;/td&gt;
&lt;td&gt;Add: VC++ runtime if you use the destkop installer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.60.0&lt;/td&gt;
&lt;td&gt;Add: Manage your Virtual Machines like session hosts: Click on Azure - Virtual Machines to list all VMs in your subscriptions (note: data for the VMs are are delayed (resource graph))&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.59.0&lt;/td&gt;
&lt;td&gt;Change: Rollback of advanced logging of create VM / create Image Powershell script: Shows unimportand messages as an error with existing images&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.57.0&lt;/td&gt;
&lt;td&gt;Add: You can enable diagnostic settings directly on a host pool, appgroup and workspace (right-click); Fix: Sometimes reading the state of a script extension is not directly possible. This cause that the WVDAdmin log shows an error even if everything works as expected&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.56.0&lt;/td&gt;
&lt;td&gt;Change: Single session nodes are not listed under the session host node if more then 100 sessions exist to speed up WVDAdmin - all sessions are still in the session list&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.54.0&lt;/td&gt;
&lt;td&gt;Add: Function to delete unused disks and nics; Add: More logging for the rollout of session hosts; Add: New VM-types, like L4s_v2, …&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.53.0&lt;/td&gt;
&lt;td&gt;Add: Add session hosts automatically to Loadbalancer Backend Pools; Add: If a VM resource is unavailable, the first alternative VM size will be tried&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.51.0&lt;/td&gt;
&lt;td&gt;Add: Custom script to install &lt;a href=&quot;https://www.sepago.de/en/azure-monitor-en&quot;&gt;Azure Monitor for WVD from sepago&lt;/a&gt; to existing session hosts&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.50.0&lt;/td&gt;
&lt;td&gt;Add: Support for Dhsv3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.46.0&lt;/td&gt;
&lt;td&gt;Add: You can now rollout new session hosts with accelerated network configuration, Change: NICs are now created with the name of the VM&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.45.0&lt;/td&gt;
&lt;td&gt;Add: Add session hosts automatically to ASGs&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&quot;../assets/files/WVDAdmin_1.6.42.msi&quot;&gt;1.6.42.0&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Add: Support for Dasv4-series&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.41.0&lt;/td&gt;
&lt;td&gt;Add: Experimental feature: Add applications to session hosts from Windows Package Manager repository&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.40.0&lt;/td&gt;
&lt;td&gt;Change: Having a script-path for building images is no longer needed. If you leave the text box empty, the local script coming with WVDAdmin will be used and directly send to the VM&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.35.0&lt;/td&gt;
&lt;td&gt;Add: On a session host &amp;gt; State &amp;gt; Mouse over will show the health report of the host&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.34.0&lt;/td&gt;
&lt;td&gt;Fix: The drop-down list “Feature release” was not shown correctly. Feature release is the selector between the different WVD/AVD versions like Fall (WVD classic) and Spring (WVD modern on ARM)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.32.0&lt;/td&gt;
&lt;td&gt;Add: You can run scripts on multiple classic session hosts: Win Updates: Install new available updates; Custom script: Custom script located in the program files folder of WVDAdmin&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.30.0&lt;/td&gt;
&lt;td&gt;Add: Sorting order for WVD/AVD resources&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.29.0&lt;/td&gt;
&lt;td&gt;Add: Support for Eav4 and Easv4-series&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.28.0&lt;/td&gt;
&lt;td&gt;Add: Speed up adding a lot of VMs to the treeview&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.27.0&lt;/td&gt;
&lt;td&gt;Add: Support for using availability zones. Select it from the drop-down list right to the resource group list&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.26.0&lt;/td&gt;
&lt;td&gt;Add: You can run scripts on multiple ARM session hosts: Win Updates: Install new available updates; Custom script: Custom script located in the program files folder of WVDAdmin&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.24.0&lt;/td&gt;
&lt;td&gt;Add: Multi selection and action on session hosts for ARM if you select a session host container; Fix: Scale Set instances wasn’t shown in 1.6.23&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.23.0&lt;/td&gt;
&lt;td&gt;Fix: New image was not visualized in the tree view after creation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.22.0&lt;/td&gt;
&lt;td&gt;Add: Support for shared image galleries: Add a shared image gallery from the Azure Portal into a resource group managed by WVDAdmin. In WVDAdmin right-click an existing image and select “copy to shared image gallery”. An image can be rolled-out right clicking the shared image&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.21.0&lt;/td&gt;
&lt;td&gt;Add: Double-click on the tag Logs, Sessions or Sessions V2 enlarge the part of the windows (double-click again to revert)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.18.0&lt;/td&gt;
&lt;td&gt;Fix: API change from Microsoft cause that updating a host pool property fails if the location is written like “Central US” (centralus is no problem); Add: First version able to deploy session hosts from images in a image gallery&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.16.0&lt;/td&gt;
&lt;td&gt;Add: Session hosts icons  are now based on the availability state; Fix: Enumerating thousands of sessions with thousands of session hosts takes longer as expected (&amp;gt; 4 minutes)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.14.0&lt;/td&gt;
&lt;td&gt;Add: Support US Government Cloud. Activate: Add a new string Reg_SZ “Environment” with value “US” to HKCU\SOFTWARE\ITProCloud\WVDAdmin”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.12.0&lt;/td&gt;
&lt;td&gt;Add: Support for VM types: Dv4 and Dsv4-series, Ev4 and Esv4-series&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.11.0&lt;/td&gt;
&lt;td&gt;Fix: WVD/AVD ARM resources are deployed with the tags; Workspaces and host pools are separated by subscription name&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.9.00&lt;/td&gt;
&lt;td&gt;Fix: Generating toke for Spring host pool fails sometimes (Error: ExpirationTime value must be between one hour and 30 days from now”  - An error occurred while gathering an WVD2 token from backend: Object reference not set to an instance of an object.)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.5.00&lt;/td&gt;
&lt;td&gt;Add: Support for DD_v2 and DDS_V4 virtual machine types; Fix: Forwarding from the WVD/AVD API cause a authentication lost (error 401, 403 reading resources in the FALL update)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.4.00&lt;/td&gt;
&lt;td&gt;Add: Support for GEN2 virtual machines&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.2.00&lt;/td&gt;
&lt;td&gt;Add: New naming feature for new session host. Default (is): Name for a session host is the highest matching name +1; new concept (must be enabled): Name for a session host is the next free name. To enable add a reg dword to HKCU\Software\ITProCloud\WVDAdmin Name:NamingMode and value to “1”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.1.00&lt;/td&gt;
&lt;td&gt;Fix: Default session limit for V2 host pool is now 999999&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.6.0.00&lt;/td&gt;
&lt;td&gt;Change: The tag WVD.Path is aligned to Microsoft naming of “tenant” and “host pool” for the spring update. Tenant=resource group name and no longer subscription name&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.5.9.00&lt;/td&gt;
&lt;td&gt;Add: Load assigned users button to the app group tab (fall update)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.5.7.00&lt;/td&gt;
&lt;td&gt;Add: You can join existing VM’ to a host pool (VMs must be domain joined and not in a host pool right now)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.5.6.00&lt;/td&gt;
&lt;td&gt;Add: You can now move session host around host pools not created with WVDAdmin (it downloads the necessary files automatically); you can join existing VM’ to a host pool (VMs must be domain joined)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.5.5.00&lt;/td&gt;
&lt;td&gt;Fix: Enumerating VMs was endless in some circumstance&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.5.4.00&lt;/td&gt;
&lt;td&gt;Add: Migration from Fall to Spring Update; moving session hosts to another host pool&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.5.3.00&lt;/td&gt;
&lt;td&gt;Fix: Improvement updating the treeview&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.5.0.00&lt;/td&gt;
&lt;td&gt;Add:  &lt;a href=&quot;https://blog.itprocloud.de/Windows-Virtual-Desktop-Spring-Update,-Spring-Release&quot;&gt;Supporting the WVD Spring Release / Spring Update&lt;/a&gt; ; Some user operations from the session grid are now async; Fix: Spontaneous resize of the windows if data are reloaded&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.4.9.00&lt;/td&gt;
&lt;td&gt;Add: Filter users, session hosts and host pools in the overview of sessions&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.4.8.00&lt;/td&gt;
&lt;td&gt;Add: Support to add users by groups from Azure Active Directory, including an AAD browser (check my &lt;a href=&quot;https://blog.itprocloud.de/Windows-Virtual-Desktop-Add-Users-and-Groups-to-WVD/&quot;&gt;blog post&lt;/a&gt; and configure the service principal to use this feature)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.4.6.00&lt;/td&gt;
&lt;td&gt;Add: New VM sizes; all new scale sets are deployed as really scalable version (up to 600 instances each)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.4.4.00&lt;/td&gt;
&lt;td&gt;Fix: Service Principal Keys with some special characters are working now; Add: Faster loading of resources from WVD/AVD and Azure backend&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.4.2.00&lt;/td&gt;
&lt;td&gt;Add: Support for NVv4 VM sizes (based on AMD Radeon Instinct  MI25-GPU); support to set custom Azure tags for resources while deploying resources&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.4.0.00&lt;/td&gt;
&lt;td&gt;Fix: From an older version, disks are deployed as standard-hdd even if premium-disk was selected; Change: Connection views are now located parallel to the logging list on the bottom (tenant-view); Add: Function to check for an updated version via &lt;a href=&quot;../assets/files/WVDAdmin.xml&quot;&gt;https://blog.itprocloud.de/assets/files/WVDAdmin.xml&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.3.6.00&lt;/td&gt;
&lt;td&gt;Add: New tag for session hosts: WVD.Path - used by &lt;a href=&quot;http://loganalytics.sepago.com/&quot;&gt;Azure Monitor for WVD&lt;/a&gt; and &lt;a href=&quot;https://github.com/MarcelMeurer/Project-MySmartScale&quot;&gt;Azure Autoscale for WVD - aka Project MySmartScale&lt;/a&gt; if an installed language pack conflicts with the Microsoft RDAgent (read this &lt;a href=&quot;https://blog.itprocloud.de/Windows-Virtual-Desktop-Language-Packs-Detecting-Host-Pool-and-Tenant-Name/&quot;&gt;post&lt;/a&gt; to learn more)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.3.5.00&lt;/td&gt;
&lt;td&gt;Add: Allow an local admin to shadow a user session (WVDAdmin needs direct access to the session host via RDP)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.3.4.00&lt;/td&gt;
&lt;td&gt;Add: Networks are now listed as VNET/SUBNET in the rollout tab&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.3.3.00&lt;/td&gt;
&lt;td&gt;Add: Support for a special mode if your WVD/AVD tenant and the session hosts in two different Azure Active Directory tenants&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.3.1.00&lt;/td&gt;
&lt;td&gt;Fix: WVDAdmin crashed if 1.3.0 is your first version of WVDAdmin (HKEY_CURRENT_USER\Software\ITProCloud doesn’t exist while checking for multi-tenancy mode)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.3.0.00&lt;/td&gt;
&lt;td&gt;Add: AAD multi-tenancy mode (drop down list to handle different AADs) - &lt;a href=&quot;https://blog.itprocloud.de/Windows-Virtual-Desktop-Windows-Virtual-Desktop-Administration-for-CSP-and-Consulting-Partners/&quot;&gt;https://blog.itprocloud.de/Windows-Virtual-Desktop-Windows-Virtual-Desktop-Administration-for-CSP-and-Consulting-Partners&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.2.8.00&lt;/td&gt;
&lt;td&gt;Add: If you click a tenant a tenant wide list of sessions is listed.  Logoff or send messages to multiple sessions&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.2.7.00&lt;/td&gt;
&lt;td&gt;Add: The main window of the application is now resizeable&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.2.5.00&lt;/td&gt;
&lt;td&gt;Add: Support for Scale Sets (with normal and ephemeral disks) -&amp;gt; see below&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.2.4.00&lt;/td&gt;
&lt;td&gt;Add: Support for availability sets&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.2.3.00&lt;/td&gt;
&lt;td&gt;Add: Support for automatic and static assigned host pools&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.2.1.00&lt;/td&gt;
&lt;td&gt;&lt;a name=&quot;v121-note&quot;&gt;&lt;/a&gt;Fix: Logging of rollout parameter by Azure custom extension is removed to avoid logging secrets&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.0.0.30&lt;/td&gt;
&lt;td&gt;Fix: Rollout - OU can now be empty to join the default OU&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.0.0.29&lt;/td&gt;
&lt;td&gt;Add: Supporting “special license mode” to save up to 50% on compute-cost (&lt;a href=&quot;https://docs.microsoft.com/en-us/azure/virtual-desktop/apply-windows-license&quot;&gt;https://docs.microsoft.com/en-us/azure/virtual-desktop/apply-windows-license&lt;/a&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.0.0.26&lt;/td&gt;
&lt;td&gt;Add: Template VM can now be a VM with a standard disk (non-managed)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.0.0.25&lt;/td&gt;
&lt;td&gt;Fix: If you delete a VM the OS disk will deleted as well&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.0.0.23&lt;/td&gt;
&lt;td&gt;Support for ephemeral  disks&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1.0.0.22&lt;/td&gt;
&lt;td&gt;First published version - without auto-update of WVDAdmin&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/details&gt;&lt;br/&gt;
&lt;h2 id=&quot;configuration&quot;&gt;Configuration&lt;/h2&gt;
&lt;h2 id=&quot;service-principal-functional-account&quot;&gt;Service principal (functional account)&lt;/h2&gt;
&lt;p&gt;To work with the GUI, you need a service principal (function account) with permission to administrate access to the WVD/AVD and Azure resources. I decide to use a service principal to avoid confusion if my Azure AD user is only a guest account in the WVD/AVD tenant I have to administrate and easily switch between different tenants.&lt;/p&gt;
&lt;p&gt;To create a service principal, go to your Azure AD -&amp;gt; &lt;a href=&quot;https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredApps&quot; target=&quot;_blank&quot;&gt;App registration&lt;/a&gt; -&amp;gt; New registration and type a name for your principal like “ svc_WVDAdmin” and press “register”.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/documentation-001.png&quot; alt=&quot;documentation-001&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Click on “certificates &amp;amp; secrets”. Click “new client secret”, select a validity period and a description (like “Key01”). Press “add”.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/documentation-002.png&quot; alt=&quot;documentation-002&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Copy the generated key directly - it will never be displayed again. Note the key for later.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/documentation-003.png&quot; alt=&quot;documentation-003&quot; /&gt;&lt;/p&gt;
&lt;p&gt;To assign users to app groups, the service principal needs two API permissions to get the users and groups from Azure AD:&lt;/p&gt;
&lt;p&gt;Add the permission “Microsoft Graph” -&amp;gt; Application Permission -&amp;gt; Directory.Read.All&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/SP-PermissionToReadDirectoryObjects-01b.png&quot; alt=&quot;AADBrowser&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;From version 1.7.17 and AVD (spring version) you can skip this permission (is no longer available in Azure for new installations):&lt;/strong&gt; API Permissions: Add the permission “Azure Active Directory Graph” -&amp;gt; Application Permission -&amp;gt; Directory.Read.All&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/SP-PermissionToReadDirectoryObjects-01.png&quot; alt=&quot;AADBrowser&quot; /&gt;&lt;/p&gt;
&lt;p&gt;To consent, the permission and administrator of Azure AD have to grant this:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/SP-PermissionToReadDirectoryObjects-02.png&quot; alt=&quot;AADBrowser&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Go to “Overview”. Note the “Application (client) ID” and the “Directory (tenant) ID” as well.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/documentation-004.png&quot; alt=&quot;documentation-004&quot; /&gt;&lt;/p&gt;
&lt;p&gt;You now have all data for your service principal:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Tenant id&lt;/li&gt;
&lt;li&gt;Service principal id (application id)&lt;/li&gt;
&lt;li&gt;Service principal key&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;wvd-permissions-classic--fall-version&quot;&gt;WVD permissions (Classic / Fall Version)&lt;/h2&gt;
&lt;p&gt;This chapter is for WVD Classic / Fall. &lt;a href=&quot;#wvd-permissions-arm--spring-version&quot;&gt;Skip&lt;/a&gt; this chapter if you only work with WVD/AVD ARM (Spring).&lt;/p&gt;
&lt;p&gt;To use WVDAdmin you need at least an existing WVD/AVD tenant. If you new to WVD/AVD follow this article to create a WVD/AVD tenant:  [https://docs.microsoft.com/en-us/azure/virtual-desktop/virtual-desktop-fall-2019/tenant-setup-azure-active-directory)&lt;/p&gt;
&lt;p&gt;You have to use PowerShell to give the WVD/AVD the appropriated permission:&lt;/p&gt;
&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;Import-Module&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Microsoft.RDInfra.RDPowerShell&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# log on with an administrative user account to your &lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Add-RdsAccount&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DeploymentUrl&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://rdbroker.wvd.microsoft.com&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  

&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# list rds tenants&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Get-RdsTenant&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# give your service principal the right permission&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;New-RdsRoleAssignment&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-TenantName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Builder City&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-RoleDefinitionName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;RDS Owner&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ApplicationId&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;89050a12-xxxx-xxxx-xxxx-000000000000&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/documentation-005.png&quot; alt=&quot;documentation-005&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;wvdavd-permissions-arm--spring-version&quot;&gt;WVD/AVD permissions (ARM / Spring Version)&lt;/h2&gt;
&lt;p&gt;This chapter is for WVD/AVD ARM / Spring. &lt;a href=&quot;#azure-resource-permissions&quot;&gt;Skip&lt;/a&gt; this chapter if you only work with WVD Classic (Fall).&lt;/p&gt;
&lt;p&gt;The service principal needs permission to add and modify WVD/AVD resource objects (host pools, workspaces, app groups). To assign users and groups to app groups, the service principal needs the owner role on the resource groups you want to use for your WVD/AVD environment. Add the service principal in the next step and use the &lt;strong&gt;owner&lt;/strong&gt; role.&lt;/p&gt;
&lt;h2 id=&quot;register-resource-provider-arm--spring-version&quot;&gt;Register Resource Provider (ARM / Spring Version)&lt;/h2&gt;
&lt;p&gt;This chapter is for WVD/AVD ARM / Spring. &lt;a href=&quot;#azure-resource-permissions&quot;&gt;Skip&lt;/a&gt; this chapter if you only work with WVD/AVD Classic (Fall).&lt;/p&gt;
&lt;p&gt;If you have never worked with WVD, you have to register the WVD/AVD resource provider once. To do that, go to the Azure portal -&amp;gt; subscriptions -&amp;gt; select your subscription -&amp;gt; Resource providers&lt;/p&gt;
&lt;p&gt;Search for “Microsoft.DesktopVirtualization” and click on “Register”.
&lt;img src=&quot;../assets/images/WVDAdmin/documentation-015.png&quot; alt=&quot;documentation-015&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;azure-resource-permissions&quot;&gt;Azure resource permissions&lt;/h2&gt;
&lt;p&gt;The service principal needs permission to subscriptions or resource groups to manage your WVD/AVD resources, imaging template VM and rollout session hosts.&lt;/p&gt;
&lt;p&gt;Open the Azure portal and go to the resource groups you want to use or to the subscriptions. In each resource group/subscription, click “Access control (IAM)” -&amp;gt; select “Add” -&amp;gt; Add role assignment. Select “owner” and search in “Select” for your service principal name. Click on the principal and save the settings.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; Owner is needed to assign users to app groups. For other resources, “contributor” is fine.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/documentation-006.png&quot; alt=&quot;documentation-006&quot; /&gt;&lt;/p&gt;
&lt;p&gt;The service principal must have permissions to your virtual network (vnet) to assign new VMs to the right subnet. Go to your vnet, click “Access control (IAM)” -&amp;gt; select “Add” -&amp;gt; Add role assignment. Select “contributor” and search in “select” for your service principal name. Click the principal and save the settings. You could skip this step if you assigned the service principal to the subscription or to the resource group containing your vnet.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/documentation-007.png&quot; alt=&quot;documentation-007&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;prepare-your-native-active-directory&quot;&gt;Prepare your “native” Active Directory&lt;/h2&gt;
&lt;p&gt;Today each session host must be part of a “native” active directory domain (or have to use the domain services). To add new session hosts unattended, we need an administrative user account to add a computer object to the active directory domain. You can use an existing one, or you can create a new service user:&lt;/p&gt;
&lt;p&gt;Open “Active Directory Users and Computers” and create a user object with a complex password, and set a password to “never expire” (if you fine with this). I added the user &lt;a href=&quot;mailto:srv_WVD-Join@itprocloud.de&quot;&gt;srv_WVD-Join@itprocloud.de&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Delegate permission for the user to an OU. I found a really good blog post from &lt;a href=&quot;https://twitter.com/prajwaldesai&quot;&gt;Prajwal Desai&lt;/a&gt;. Check out hist post on (external web site): &lt;a href=&quot;https://www.prajwaldesai.com/allow-domain-user-to-add-computer-to-domain/&quot; target=&quot;_blank&quot;&gt;Method 2 – Delegate rights to user/group using Active Directory Users and Computers&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In my case I added my function account to: “OU=WVD,OU=Azure,OU=Site,OU=Servers,OU=Sys,OU=Organisation,DC=ITProCloud,DC=test”&lt;/p&gt;
&lt;h2 id=&quot;optional-create-a-file-share&quot;&gt;Optional: Create a file share&lt;/h2&gt;
&lt;p&gt;In earlier versions (&amp;lt;1.6.40), you had to provide the deployment script and the WVD/AVD agent binaries on a custom file share or blob storage. With WVDAdmin 1.6.40 or newer, this no longer mandatory.
In some cases, where virtual machines don’t have access to the internet to download the WVD/AVD agent binaries, you can use a custom file share.&lt;/p&gt;
&lt;details&gt;&lt;summary&gt;Read more.&lt;/summary&gt;&lt;br/&gt;
&lt;p&gt;&lt;em&gt;Hint: Alternatively, you can use Azure blob storage to store the script. Make the blob storage read-only and use the URL as rollout script-path. E.g.: &lt;a href=&quot;https://sharedservices01.blob.core.windows.net/wvd&quot;&gt;https://sharedservices01.blob.core.windows.net/wvd&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Create a file share for the configuration script (which adds new session hosts to the domain and install the WVD/AVD agent). Give everyone at least read permissions. Set the NTFS permissions to everyone and read. This is necessary while during the first startup, the VM extension tries to execute the script. In this process, the file share is accessed anonymously.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/documentation-009.png&quot; alt=&quot;documentation-009&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/documentation-010.png&quot; alt=&quot;documentation-010&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Place the following files in this share:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.itprocloud.de/assets/files/AutoUpdate/Scripts/ITPC-WVD-Image-Processing.ps1.txt&quot;&gt;ITPC-WVD-Image-Processing.ps1&lt;/a&gt; (rename the download to .ps1)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RWrmXv&quot;&gt;Microsoft.RDInfra.RDAgent.msi&lt;/a&gt; (rename the file)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RWrxrH&quot;&gt;Microsoft.RDInfra.RDAgentBootLoader.msi&lt;/a&gt; (rename the file)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Make sure that you rename the files to fit the list above (without version numbers).&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/documentation-011.png&quot; alt=&quot;documentation-011&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Important:&lt;/strong&gt; If you are using Windows Server &lt;strong&gt;2019&lt;/strong&gt; as file share, make sure that anonymous file share access is enabled. Create a GPO for the session hosts containing the following configurations:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Security Options:
&lt;ul&gt;
&lt;li&gt;Accounts: Guest Account Status: Enabled&lt;/li&gt;
&lt;li&gt;Network access: Let Everyone permissions apply to anonymous users: Enabled&lt;/li&gt;
&lt;li&gt;Network access: Do not allow anonymous enumeration of SAM accounts and shares: Disabled&lt;/li&gt;
&lt;/ul&gt;
&lt;/details&gt;&lt;br/&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;configure-wvdadmin&quot;&gt;Configure WVDAdmin&lt;/h1&gt;
&lt;p&gt;Please start WVDAdmin. Before you load WVD/AVD and Azure data, copy the Azure tenant id, service principal id, and service principal key into the welcome tab. Press save and load the data by clicking “Reload all”.&lt;/p&gt;
&lt;p&gt;You are now able to administrate WVD, create images from template VMs and rollout new session hosts.&lt;/p&gt;
&lt;p&gt;The first time you want to roll out new session hosts, you have to enter some information from your Active Directory and file share configuration from above:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/documentation-012.png&quot; alt=&quot;documentation-012&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Local Admin and local pw. are the local administrator account credentials which you can enter at this time.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/documentation-013.png&quot; alt=&quot;documentation-013&quot; /&gt;&lt;/p&gt;
&lt;h1 id=&quot;build-an-image&quot;&gt;Build an image&lt;/h1&gt;
&lt;p&gt;You can rollout VMs and VM Scale Set with images created by WVDAdmin. These images contain the logic to join the AD domain and WVD.&lt;/p&gt;
&lt;p&gt;You can simple create an image from a template VM. The template VM must part of your AD like a standard client. You have not to sysprep or to normalize this template VM. Use the same template VM for Windows and application updates.&lt;/p&gt;
&lt;p&gt;Following these steps to build your template:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Install a VM in the Azure portal. Select the right OS (like Windows 10 Enterprise for Virtual Desktops)&lt;/li&gt;
&lt;li&gt;Make all Windows updates&lt;/li&gt;
&lt;li&gt;Join the VM to your AD&lt;/li&gt;
&lt;li&gt;Install your application&lt;/li&gt;
&lt;li&gt;Make your customizing (like installing language packages)&lt;/li&gt;
&lt;li&gt;Shutdown the template VM&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To create the image, open WVDAdmin and&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Navigate to the Azure template VM (Azure -&amp;gt; Virtual Machines -&amp;gt; RG -&amp;gt; VM)&lt;/li&gt;
&lt;li&gt;Right-click -&amp;gt; “Create a template image”&lt;/li&gt;
&lt;li&gt;Select the resource group to store the image&lt;/li&gt;
&lt;li&gt;Press “Capture”&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can and should reuse the template VM for new updates and applications. After these changes, shut down the template VM and create a new image.&lt;/p&gt;
&lt;h1 id=&quot;tipps-amp-tricks&quot;&gt;Tipps &amp;amp; Tricks&lt;/h1&gt;
&lt;h2 id=&quot;vm-scale-sets&quot;&gt;VM Scale Sets&lt;/h2&gt;
&lt;p&gt;First node: VM Scale Sets cannot autoscale WVD/AVD session hosts. Auto-scaling only works for stateless services like a web server. But if you need hundreds of session hosts, then VM Scale Set allows you to work with these numbers efficiently.&lt;/p&gt;
&lt;details&gt;&lt;summary&gt;Read more&lt;/summary&gt;&lt;br/&gt;
From version 1.2.5, WVDAdmin support VM Scale Sets. A Scale Set can have several instances, which are the VMs / session hosts. There are some essential things you have to know if you use VM Scale Set with WVDAdmin and WVD/AVD itself:
&lt;ul&gt;
&lt;li&gt;Build a Scale Set with WVDAdmin. Select an image, right-click and select “Create session host from image”. Check “Rollout as VM Scale Set”&lt;/li&gt;
&lt;li&gt;You can use regular disks and ephemeral disks. If you use ephemeral disks, you cannot deallocate the instances of your Scale Set. You have to delete the instances&lt;/li&gt;
&lt;li&gt;Today, you can not use ultra disks&lt;/li&gt;
&lt;li&gt;You can add and remove instances with WVDAdmin or in the Azure Portal. New instances will join the domain and WVD&lt;/li&gt;
&lt;li&gt;A new instance can only join WVD/AVD if the session host with the new name doesn’t exist. If you delete instances, the session host entry will also be removed&lt;/li&gt;
&lt;li&gt;You can re-image single instances or all instances of a Scale Set. After that, the instances are “clean” as at the first rollout&lt;/li&gt;
&lt;li&gt;Adding instances or re-imaging assumes that the Scale Set configuration (which is a custom script extension) has a valid WVD/AVD token to join new instances to WVD. While WVD/AVD provides only one token per host pool and that the token can be expiring, you can update the token with a right-click on the Scale Set and select “Update WVD token”. The max. lifetime of a token is 59 days&lt;/li&gt;
&lt;li&gt;Unfortunately, WVDAdmin cannot change the source image for a VM Scale Set. So if you want to update the image for a host pool, take these steps:
&lt;ul&gt;
&lt;li&gt;Rollout a new Scale Set based on the new image&lt;/li&gt;
&lt;li&gt;Disable new logons for the old session host from the previous Scale Set&lt;/li&gt;
&lt;li&gt;Test the host pool based on the new Scale Set&lt;/li&gt;
&lt;li&gt;If no user logged on to the ancient Scale Set, remove all instances from the Scale Set (this deletes the session hosts in WVD/AVD as well)&lt;/li&gt;
&lt;li&gt;Remove the Scale Set&lt;/li&gt;
&lt;/ul&gt;
&lt;/details&gt;&lt;br/&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;ephemeral--disks&quot;&gt;Ephemeral  disks&lt;/h2&gt;
&lt;p&gt;Ephemeral disks are awesome. They give you a high performance free of charge. Especially in a WVD/AVD multiuser environment where no data a stored permanently on the session hosts, this kind of disk can give you some value add.&lt;/p&gt;
&lt;details&gt;&lt;summary&gt;Read more&lt;/summary&gt;&lt;br/&gt;
Ephemeral disks are running on the Azure hypervisor and not stored. This has some advantages:
&lt;ul&gt;
&lt;li&gt;There are no storage costs (!)&lt;/li&gt;
&lt;li&gt;A very high data throughput because the disks exist on the hypervisor&lt;/li&gt;
&lt;li&gt;See &lt;a href=&quot;https://twitter.com/michawets&quot;&gt;@MichaWets&lt;/a&gt;   blog post for more information:  &lt;a href=&quot;https://www.cloud-architect.be/2019/07/15/windows-virtual-desktop-running-on-ephemeral-os-disks/&quot;&gt;https://www.cloud-architect.be/2019/07/15/windows-virtual-desktop-running-on-ephemeral-os-disks/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Please note:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You can not deallocate a VM with this disk type - you have to delete the VM (and roll out a new one instead of starting a “normal” VM)&lt;/li&gt;
&lt;li&gt;Not each VM size is available, and there are limitations of the disk size (image size for rollout) based on the VM size: Max ephemeral disk size for  Standard_D4s_v3  is 64 GByte while a  Standard_D8s_v3 can have up to 128 GByte. See &lt;a href=&quot;https://docs.microsoft.com/en-us/azure/virtual-machines/linux/sizes-general&quot;&gt;https://docs.microsoft.com/en-us/azure/virtual-machines/linux/sizes-general&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;If the Azure hypervisor fails, your session host will fail as well and can not be re-deployed automatically&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin/documentation-014.png&quot; alt=&quot;documentation-001&quot; /&gt;&lt;/p&gt;
&lt;/details&gt;&lt;br/&gt;
&lt;h2 id=&quot;secret-features&quot;&gt;Secret Features&lt;/h2&gt;
&lt;p&gt;WVDAdmin has some features not directly visible but configurable via registry keys. All settings in the registry are in the current user part under HKEY_CURRENT_USER\SOFTWARE\ITProCloud\WVDAdmin. Keep in mind to restart WVDAdmin after changing the registry settings.&lt;/p&gt;
&lt;details&gt;&lt;summary&gt;Read more&lt;/summary&gt;&lt;br/&gt;
&lt;h3 id=&quot;multi-tenant-mode&quot;&gt;Multi-Tenant-Mode&lt;/h3&gt;
&lt;p&gt;From version 1.3.0 WVDAdmin will support a multi-AAD-tenancy mode allowing to switch the Azure AD tenant very easily.
&lt;a href=&quot;../Windows-Virtual-Desktop-Windows-Virtual-Desktop-Administration-for-CSP-and-Consulting-Partners&quot;&gt;Follow this link&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;having-multiple-service-principals-for-a-single-tenant&quot;&gt;Having multiple Service Principals for a single Tenant&lt;/h3&gt;
&lt;p&gt;In the Multi-Tenant-Mode, you can add one service principal per tenant. Sometimes you need more service principals for the same tenant. You can add more service principals for a tenant if you append #1 directly behind the tenant id (or #2, …).&lt;/p&gt;
&lt;h3 id=&quot;naming-of-the-session-hosts&quot;&gt;Naming of the Session Hosts&lt;/h3&gt;
&lt;p&gt;If you deploy session hosts to a host pool, WVDAdmin counts up the names from the highest available VM. E.g., if you have a session host with the name “WVD-PROD-012” and you rollout new hosts (WVD-PROD-###), the first new hostname is “WVD-PROD-013” - even if you have gaps in the existing numeration. You can force WVDAdmin to fill this gaps (non-existing hosts in the naming schema) if you set the following registry key:
Reg-DWord: &lt;strong&gt;NamingMode&lt;/strong&gt; = &lt;strong&gt;1&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;split-tenant&quot;&gt;Split-Tenant&lt;/h3&gt;
&lt;p&gt;Usually, the WVD/AVD tenant and the resources (sessions hosts) are in the same AAD tenant. If you have two Azure AD tenant, you can use WVDAdmin with a second service principal for the session hosts (resource tenant).
&lt;a href=&quot;../Windows-Virtual-Desktop-Admin-for-2-tenant-mode&quot;&gt;Follow this link&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;us-government-cloud&quot;&gt;US-Government Cloud&lt;/h3&gt;
&lt;p&gt;WVDAdmin can be used to deploy WVD/AVD in the Azure Government Cloud. You can enable WVDAdmin to work in the US Government Cloud via registry:
Reg-SZ: &lt;strong&gt;Environment&lt;/strong&gt; = &lt;strong&gt;US&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;run-custom-actions-simultaneously&quot;&gt;Run custom actions simultaneously&lt;/h3&gt;
&lt;p&gt;From version 1.6.15, WVDAdmin supports custom scripts to run administrative tasks simultaneously on different session hosts. And that is easy to use and to extend.
&lt;a href=&quot;../Windows-Virtual-Desktop-Admin-CustomScripts&quot;&gt;Follow this link&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;add-a-session-host-automatically-to-an-asg&quot;&gt;Add a session host automatically to an ASG&lt;/h3&gt;
&lt;p&gt;You can add a session host automatically to application security groups (ASG) within the rollout process. To achieve this, add one or more tags to the host pool containing your new session hosts. Name &lt;strong&gt;WVD.Default.ASG.X&lt;/strong&gt; and add the azure resource id of an existing asg. X can be numbers to assign more ASGs. You can copy the id from an ASG from your browser. It looks like this: /subscriptions/&amp;lt;subscription-id&amp;gt;/resourcegroups/&amp;lt;resourcegroup-name&amp;gt;/providers/Microsoft.Network/applicationSecurityGroups/&amp;lt;asg-name&amp;gt;
&lt;img src=&quot;../assets/images/WVDAdmin/asg-001.png&quot; alt=&quot;Tag for ASG&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;add-a-session-host-automatically-to-a-loadbalancer-backend-pool&quot;&gt;Add a session host automatically to a Loadbalancer Backend Pool&lt;/h3&gt;
&lt;p&gt;You can add a session host automatically to a loadbalancer backend pool within the rollout process. To achieve this, add one or more tags to the host pool containing your new session hosts. Name &lt;strong&gt;WVD.Default.LBPool.X&lt;/strong&gt; and add the azure resource id of an existing loadbalancer backend pool. X can be numbers to assign more ASGs. You can copy the id from a pool from your browser. It looks like this: /subscriptions/&amp;lt;subscription-id&amp;gt;/resourcegroups/&amp;lt;resourcegroup-name&amp;gt;/providers/Microsoft.Network/loadBalancers/&amp;lt;loadbalancer-name&amp;gt;/backendAddressPools/&amp;lt;pool-name&amp;gt;
Keep in mind to use availability sets for each rollout to use this feature.&lt;/p&gt;
&lt;h3 id=&quot;rollout-session-hosts-with-azure-disk-encryption-ade&quot;&gt;Rollout session hosts with Azure Disk Encryption (ADE)&lt;/h3&gt;
&lt;p&gt;Set two tags to the host pool to use it: “WVD.Default.KeyVault.Id” with the resource id of the KeyVault, “WVD.Default.KeyVault.KeyUri” with the URI (including the version) of the prepared key to wrap the secret.&lt;/p&gt;
&lt;/details&gt;&lt;br/&gt;
&lt;h1 id=&quot;troubleshooting&quot;&gt;Troubleshooting&lt;/h1&gt;
&lt;h2 id=&quot;create-an-image&quot;&gt;Create an Image&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;The image is not created. An error message occurs:&lt;/li&gt;
&lt;li&gt;Check if your template VM part of the AD&lt;/li&gt;
&lt;li&gt;If your file server Windows Server 2019, read above&lt;/li&gt;
&lt;li&gt;Check if you have set the NTFS and share permission correctly&lt;/li&gt;
&lt;li&gt;Azure portal: Go to the temp VM (next to the template VM) and check the extension installation state. There should be an error message like script not found, access denied, etc.&lt;/li&gt;
&lt;li&gt;Have you renamed the RD agent and bootloader?&lt;/li&gt;
&lt;li&gt;Is the script saved correctly: ITPC-WVD-Image-Processing.ps1, not ITPC-WVD-Image-Processing.ps1.txt&lt;/li&gt;
&lt;li&gt;Don’t forget to delete the temp VM and temp disk to avoid costs&lt;/li&gt;
&lt;li&gt;Make sure that your template VM uses managed disk&lt;/li&gt;
&lt;li&gt;The script generates additional log files in %WinDir%\System32\LogFiles&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Windows 7&lt;/em&gt;: Make sure to install PowerShell 5.1 and all Windows updates (including the optional updates without the language packages) to the template VM and restart the VM to take effect: &lt;a href=&quot;https://www.microsoft.com/en-us/download/details.aspx?id=54616&quot;&gt;https://www.microsoft.com/en-us/download/details.aspx?id=54616&lt;/a&gt; Makes sure that you use the newest script file from 09/2020: &lt;a href=&quot;https://blog.itprocloud.de/assets/files/AutoUpdate/Scripts/ITPC-WVD-Image-Processing.ps1.txt&quot;&gt;ITPC-WVD-Image-Processing.ps1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;NEW: An endless loop of “Waiting for the temporary vm (power off)” : Update to the newest PowerShell script for generalizing: &lt;a href=&quot;https://blog.itprocloud.de/assets/files/AutoUpdate/Scripts/ITPC-WVD-Image-Processing.ps1.txt&quot;&gt;ITPC-WVD-Image-Processing.ps1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;others&quot;&gt;Others&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;You have created a host pool, an app group, and assigned a user to the app group, but the user cannot see the apps/desktop.
&lt;ul&gt;
&lt;li&gt;For WVD/AVD ARM: Don’t forget to create a workspace and link the app group in the workspace. The workspace is mandatory to show the users’ resources.&lt;/li&gt;
&lt;li&gt;For the HTML5 web site: Check the correct web address:
&lt;ul&gt;
&lt;li&gt;ARM/Spring: &lt;a href=&quot;https://aka.ms/wvdarmweb&quot;&gt;https://aka.ms/wvdarmweb&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Classic/Fall: &lt;a href=&quot;http://aka.ms/wvdweb&quot;&gt;http://aka.ms/wvdweb&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;../assets/files/WVDAdmin.msi&quot;&gt;&lt;img src=&quot;../assets/icons/download.png&quot; alt=&quot;Download&quot; /&gt; &lt;strong&gt;Download the latest release from 09/30/2021&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Thu, 30 Sep 2021 00:00:00 +0200</pubDate>
        <link>https://blog.itprocloud.de/Windows-Virtual-Desktop-Admin/</link>
        <guid isPermaLink="true">https://blog.itprocloud.de/Windows-Virtual-Desktop-Admin/</guid>
        
        
        <category>Windows Virtual Desktop</category>
        
        <category>Azure Virtual Desktop</category>
        
      </item>
    
      <item>
        <title>Shrink FSLogix profiles automatically with Hydra</title>
        <description>&lt;h2 id=&quot;intro&quot;&gt;Intro&lt;/h2&gt;
&lt;p&gt;FSLogix profile disks increase their size over time - even if a user deletes data and the data amount goes down. Like &lt;a href=&quot;https://twitter.com/jimmoyle&quot;&gt;Jim Moyle&lt;/a&gt; wrote: “Dynamically Expanding disks do not natively shrink when the volume of data within them reduces, they stay at the ‘High water mark’ of historical data volume within them.”&lt;/p&gt;
&lt;p&gt;While you are paying for usage or allocated storage, having the profile disk small is a good way to go.&lt;/p&gt;
&lt;p&gt;Jim provides a &lt;a href=&quot;https://github.com/FSLogix/Invoke-FslShrinkDisk&quot;&gt;script&lt;/a&gt; to shrink the FSLogix profiles. Excellent work from Jim.&lt;/p&gt;
&lt;p&gt;I added a script in Hydra to download and run the script from Jim to shrink FSLogix disk. This script can be used in a script schedule on a host pool to shrink the disk maybe one time a week.&lt;/p&gt;
&lt;p&gt;Update Hydra to the newest version
Having the host target “A single host in the pool” Hydra version 1.0.1.16 is needed. You can update Hydra in the Azure portal -&amp;gt; Your Hydra web app -&amp;gt; Deployment Center -&amp;gt; Sync
&lt;img src=&quot;../assets/images/Hydra/FSLogixShrink-Disk-01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;download-the-newest-build-in-scripts&quot;&gt;Download the newest build-in scripts&lt;/h2&gt;
&lt;p&gt;Open the Hydra portal -&amp;gt; Scripts -&amp;gt; Click the button in the upper right corner:
&lt;img src=&quot;../assets/images/Hydra/FSLogixShrink-Disk-02.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;service-account&quot;&gt;Service Account&lt;/h2&gt;
&lt;p&gt;Like the feature deleting FSLogix profile, the shrink method needs a service account configured on the host pool level. The account must have read/write permission to the FSLogix file share:
&lt;img src=&quot;../assets/images/Hydra/FSLogixShrink-Disk-03.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;test-shrinking&quot;&gt;Test shrinking&lt;/h2&gt;
&lt;p&gt;Make a first test for shrinking the profile disk from the session host view. Select one session host -&amp;gt; Run script or collection -&amp;gt; BuiltIn: Shrink FSLogix Disk
&lt;img src=&quot;../assets/images/Hydra/FSLogixShrink-Disk-04.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;create-a-script-schedule-to-shrink-the-disks-automatically&quot;&gt;Create a script schedule to shrink the disks automatically.&lt;/h2&gt;
&lt;p&gt;If everything works fine, a script schedule can be configured to run the optimization maybe every week. &lt;strong&gt;It’s important to run the script only on a single host.&lt;/strong&gt;
&lt;img src=&quot;../assets/images/Hydra/FSLogixShrink-Disk-05.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Get Hydra: &lt;a href=&quot;https://azuremarketplace.microsoft.com/marketplace/apps/itprocloudgmbh1628775137215.hydra-deploy-d1&quot;&gt;Azure Marketplace&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
</description>
        <pubDate>Sat, 25 Sep 2021 00:00:00 +0200</pubDate>
        <link>https://blog.itprocloud.de/Shrink-FSLogix-Disks-automatically-with-Hydra/</link>
        <guid isPermaLink="true">https://blog.itprocloud.de/Shrink-FSLogix-Disks-automatically-with-Hydra/</guid>
        
        
        <category>Windows Virtual Desktop</category>
        
        <category>Azure Virtual Desktop</category>
        
      </item>
    
      <item>
        <title>Hydra is publicly available and listed on the Azure Marketplace</title>
        <description>&lt;p&gt;I’m pleased that my project Hydra is now listed in the Azure Marketplace as a deployable solution into the customers’ subscription - which is essential to make sure that no personal data cross the customers’ boundaries.&lt;/p&gt;
&lt;p&gt;In short:
Hydra is the solution to manage Azure Virtual Desktop for one or more tenants. Hydra’s web platform allows administrators to deploy new session hosts, configure an auto-adapt scaling, maintain session hosts and pools automatically, and much more.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/Hydra/MarketPlace.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Start it right now - it’s entirely free for environments having up to six-session hosts per pool. And even the commercial licensing is very favorable.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://azuremarketplace.microsoft.com/marketplace/apps/itprocloudgmbh1628775137215.hydra-deploy-d1&quot;&gt;Azure Marketplace&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.itprocloud.de/hydra/&quot;&gt;More about Hydra&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Thu, 02 Sep 2021 00:00:00 +0200</pubDate>
        <link>https://blog.itprocloud.de/Hydra-for-Azure-Virtual-Desktop-AVD-is-available-in-the-Azure-Marketplace/</link>
        <guid isPermaLink="true">https://blog.itprocloud.de/Hydra-for-Azure-Virtual-Desktop-AVD-is-available-in-the-Azure-Marketplace/</guid>
        
        
        <category>Windows Virtual Desktop</category>
        
        <category>Azure Virtual Desktop</category>
        
      </item>
    
      <item>
        <title>Hydra: Scripts and Script Collections for the operation and automation of Azure Virtual Desktop (AVD) / Windows Virtual Desktop (WVD)</title>
        <description>&lt;h2 id=&quot;intro&quot;&gt;Intro&lt;/h2&gt;
&lt;p&gt;Project Hydra for Azure Virtual Desktop
Six months ago, I started a new project to provide a solution to manage Azure Virtual Desktop / Windows Virtual Desktop in an automated way. It was thought of as a complement to #WVDAdmin and focused on doing some tasks automatically. For example:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Autoscale
– Multi-Session hosts
– Power-on-connect support
– Schedules
– Autopilot: Automatically scales up/down/create/remove based on the usage of a host pool
– Deploy hosts on-demand - including ephemeral VMs based on a custom image&lt;/li&gt;
&lt;li&gt;VDI
– Auto deallocate session hosts&lt;/li&gt;
&lt;li&gt;Granular session timeouts&lt;/li&gt;
&lt;li&gt;Auto Health&lt;/li&gt;
&lt;li&gt;and a lot more&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The last days, I added another essential feature to the project Hydra: Scripts and script collections. Both are intended to automize Azure VMs, and Azure Virtual Desktop (AVD) from the management perspective.&lt;/p&gt;
&lt;h2 id=&quot;scripts-and-script-collections-updated&quot;&gt;Scripts and Script Collections (Updated)&lt;/h2&gt;
&lt;p&gt;Scripts and script collections. Both are intended to automize Azure VMs, and Azure Virtual Desktop (AVD) from the management perspective.&lt;/p&gt;
&lt;h3 id=&quot;script&quot;&gt;Script&lt;/h3&gt;
&lt;p&gt;A Powershell script for a session host. The script runs in the system context with system permissions, variables containing data about the host pool, session hosts, etc. Optionally, a Powershell credential object (PSC) can be used to connect to other services, like files shares (the service account can be configured on the host pool level).&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/Hydra/Script-01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;script-collections&quot;&gt;Script Collections&lt;/h3&gt;
&lt;p&gt;A script collection is a collection of scripts and tasks in any sequence. E.g.: Drain mode on -&amp;gt; Logoff users -&amp;gt; Start the VM -&amp;gt; Run a script -&amp;gt; Restart -&amp;gt; Drain mode off&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/Hydra/ScriptCollection-01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Additionally, parameters can be set for a script, and error handling is built-in. Script collections are very useful to orchestrate several tasks and scripts to session hosts.&lt;/p&gt;
&lt;h3 id=&quot;built-in-scripts-and-collections&quot;&gt;Built-in scripts and collections&lt;/h3&gt;
&lt;p&gt;There are several built-in scripts and collections, and new scripts and collections are provided continuously. Built-in scripts can be updated with the “Update” button in the upper-right corner.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/Hydra/ScriptCollectionSync-01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;To add a custom script or script collection, copy the &lt;em&gt;“BuiltIn: 1st Template Script”&lt;/em&gt; or &lt;em&gt;“BuiltIn: 1st Template Script Collection”&lt;/em&gt;. Then start building the new one. Make sure to save the new script/collection with a click of the disk symbol. There is no warning right now if you close the browser or if you navigate to another site.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/Hydra/ScriptCollectionSaveBar-01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;triggering-a-script-or-script-collection&quot;&gt;Triggering a script or script collection&lt;/h3&gt;
&lt;p&gt;Scripts and script collections can be triggered by &lt;em&gt;Host pool administrators&lt;/em&gt; and edited by &lt;em&gt;Full administrators&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Both can be assigned/triggered in different ways:&lt;/p&gt;
&lt;h4 id=&quot;for-selected-hosts&quot;&gt;For selected hosts&lt;/h4&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/Hydra/ScriptCollectionAssign-SessionHosts-01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;automatically-after-the-rollout-of-a-new-session-host&quot;&gt;Automatically after the rollout of a new session host&lt;/h4&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/Hydra/ScriptCollectionAssign-Rollout-01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;by-a-schedule&quot;&gt;By a schedule&lt;/h4&gt;
&lt;p&gt;Schedules can be used on a host pool level to run a script or collection unattended on session hosts of the pool. Comparable to other schedules, weekday(s) and start time define the plan. The following parameters can be used to fine-tune the schedule:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Hosts&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ul&gt;
&lt;li&gt;Run on all hosts&lt;/li&gt;
&lt;li&gt;Run only on hosts without user sessions&lt;/li&gt;
&lt;li&gt;Run only on hosts in drain-mode&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Simultaneously&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ul&gt;
&lt;li&gt;Starts directly on all hosts&lt;/li&gt;
&lt;li&gt;Start on max. 5 session hosts at the same time (if one finished, the script/collection will be started on the next host)&lt;/li&gt;
&lt;li&gt;…&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/Hydra/ScriptCollectionAssign-Schedule-01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;This example runs Windows Update on all session hosts Sunday, 1:00 am. Including drain mode, start, update, restart, drain mode off.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Install Project Hydra in your subscription: &lt;a href=&quot;https://github.com/marcelmeurer/wvd-hydra&quot;&gt;https://github.com/marcelmeurer/wvd-hydra&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 10 Aug 2021 00:00:00 +0200</pubDate>
        <link>https://blog.itprocloud.de/Scripts-and-Script-Collections-available-in-Hydra-for-the-automation-of-Windows-Azure-Virtual-Desktop-AVD-WVD/</link>
        <guid isPermaLink="true">https://blog.itprocloud.de/Scripts-and-Script-Collections-available-in-Hydra-for-the-automation-of-Windows-Azure-Virtual-Desktop-AVD-WVD/</guid>
        
        
        <category>Windows Virtual Desktop</category>
        
        <category>Azure Virtual Desktop</category>
        
      </item>
    
      <item>
        <title>WVDAdmin supports AAD only deployments for AVD / WVD - AAD: Azure AD</title>
        <description>&lt;p&gt;One of the announcements of the Microsoft Inspire 2021 was the option to join session hosts #AAD only. I’m happy to have the implementation also ready in #WVDAdmin.&lt;/p&gt;
&lt;p&gt;There are some prerequisites for AAD joined session hosts:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Host pool in a validation environment&lt;/li&gt;
&lt;li&gt;RDP settings contains &lt;em&gt;targetisaadjoined:i:1&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;User must have RBAC with role &lt;strong&gt;Virtual Machine User Login&lt;/strong&gt; or &lt;strong&gt;Virtual Machine Administrator Login&lt;/strong&gt; to the VM or resource group&lt;/li&gt;
&lt;li&gt;Client device must be AAD joined (or use the web interface)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Even FSLogix cannot be used.&lt;/p&gt;
&lt;p&gt;Check the full description here: &lt;a href=&quot;https://docs.microsoft.com/en-us/azure/virtual-desktop/deploy-azure-ad-joined-vm&quot;&gt;https://docs.microsoft.com/en-us/azure/virtual-desktop/deploy-azure-ad-joined-vm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;To rollout a session host AAD only tick “AAD only” in the rollout tab. OU, domain user and password are not needed.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/WVDAdmin/AADOnlyJoin.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;An AAD-only session host shows up with the host name in the session host list - the domain suffix is missing. You can also check Azure AD to verify the connection to the AAD domain.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/WVDAdmin/AADOnlyJoin-Hosts01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;WVDAdmin: &lt;a href=&quot;https://blog.itprocloud.de/Windows-Virtual-Desktop-Admin/&quot;&gt;https://blog.itprocloud.de/Windows-Virtual-Desktop-Admin/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;What’s about #Hydra? Hydra auto-scales and manages even AAD only joined session host. Early next week, you can deploy AAD only hosts even with #Hydra&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/Hydra/Hydra-120.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;More about my project “Hydra”:&lt;/strong&gt; &lt;a href=&quot;https://github.com/marcelmeurer/wvd-hydra&quot;&gt;https://github.com/marcelmeurer/wvd-hydra&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Thu, 15 Jul 2021 00:00:00 +0200</pubDate>
        <link>https://blog.itprocloud.de/Azure-AD-only-for-AVD-session-hosts/</link>
        <guid isPermaLink="true">https://blog.itprocloud.de/Azure-AD-only-for-AVD-session-hosts/</guid>
        
        
        <category>Windows Virtual Desktop</category>
        
        <category>Azure Virtual Desktop</category>
        
      </item>
    
      <item>
        <title>Hydra: Automize, scale and manage Windows Virtual Desktop / Azure Virtual Desktop like a pro - including multi-tenancy</title>
        <description>&lt;p&gt;Project Hydra for Azure Virtual Desktop
Six months ago, I started a new project to provide a solution to manage Azure Virtual Desktop / Windows Virtual Desktop in an automated way. It was thought of as a complement to #WVDAdmin and focused on doing some tasks automatically. For example:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Autoscale
– Multi-Session hosts
– Power-on-connect support
– Schedules
– Autopilot: Automatically scales up/down/create/remove based on the usage of a host pool
– Deploy hosts on-demand - including ephemeral VMs based on a custom image&lt;/li&gt;
&lt;li&gt;VDI
– Auto deallocate session hosts&lt;/li&gt;
&lt;li&gt;Granular session timeouts&lt;/li&gt;
&lt;li&gt;Auto Health&lt;/li&gt;
&lt;li&gt;and a lot more&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Even the autoscaling part works very well. It goes hand-in-hand with Power-On-Connect and can pre-provide temporary session hosts with ephemeral disks. And for sure: It down-scales the environment.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/Hydra/Autoscaling-Example.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;More about my project “Hydra”: &lt;a href=&quot;https://github.com/marcelmeurer/wvd-hydra&quot;&gt;https://github.com/marcelmeurer/wvd-hydra&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 01 Jun 2021 00:00:00 +0200</pubDate>
        <link>https://blog.itprocloud.de/Announcement-of-my-project-Hydra-for-Azure-Windows-Virtual-Desktop-Scale,-Autopilot,-Multi-tenant-and-more/</link>
        <guid isPermaLink="true">https://blog.itprocloud.de/Announcement-of-my-project-Hydra-for-Azure-Windows-Virtual-Desktop-Scale,-Autopilot,-Multi-tenant-and-more/</guid>
        
        
        <category>Windows Virtual Desktop</category>
        
        <category>Azure Virtual Desktop</category>
        
      </item>
    
      <item>
        <title>Power-On-Connect Feature in Azure Windows Virtual Desktop and custom role for Power On Connect preview</title>
        <description>&lt;p&gt;Power-On-Connect Feature in Windows Virtual Desktop
Power-on-connect is in preview for assigned session hosts and pooled session hosts (multi-user host pool). With the new feature, users are triggering the start of the assigned session hosts or of a pooled on demand. That allows scaling up from zero hosts. Shutting down is omitted, but you can check my upcoming project to use power-on-connect with predictive autoscaling, including the shutdown of the hosts (and many other features). Check out my “preview” project “Hydra” at &lt;a href=&quot;https://github.com/MarcelMeurer/WVD-Hydra&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;You can enable power-on-connect for private host pools in the Azure Portal or with &lt;a href=&quot;https://blog.itprocloud.de/Windows-Virtual-Desktop-Admin/&quot;&gt;WVDAdmin&lt;/a&gt;. &lt;a href=&quot;https://blog.itprocloud.de/Windows-Virtual-Desktop-Admin/&quot;&gt;WVDAdmin&lt;/a&gt; also allows enabling power-on-connect for pooled/multi-user host pools.&lt;/p&gt;
&lt;p&gt;To use power-on-connect, you have to allow Microsoft to start virtual machines. To do that, create a custom role with the following link and add the &lt;em&gt;user&lt;/em&gt; “Windows Virtual Desktop” with this role to the resource group containing the virtual machines.&lt;/p&gt;
&lt;p&gt;Install the power-on-connect role
&lt;a href=&quot;https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fblog.itprocloud.de%2Fassets%2Ffiles%2FAzureDeployments%2FWVD-Role-PowerOnConnect-preview.json&quot;&gt;&lt;img src=&quot;https://aka.ms/deploytoazurebutton&quot; alt=&quot;Deploy to Azure&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Learn more at:
&lt;a href=&quot;https://docs.microsoft.com/en-us/azure/virtual-desktop/start-virtual-machine-connect&quot;&gt;https://docs.microsoft.com/en-us/azure/virtual-desktop/start-virtual-machine-connect&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 24 May 2021 00:00:00 +0200</pubDate>
        <link>https://blog.itprocloud.de/Custom-Role-for-Power-On-Connect-Preview/</link>
        <guid isPermaLink="true">https://blog.itprocloud.de/Custom-Role-for-Power-On-Connect-Preview/</guid>
        
        
        <category>Windows Virtual Desktop</category>
        
        <category>Azure Virtual Desktop</category>
        
      </item>
    
      <item>
        <title>Shrink and resize an Azure VM disk or session host disk and create smaller images from a Golden Master</title>
        <description>&lt;p&gt;A Windows 10 image from the marketplace has a size of &lt;strong&gt;128 Gbyte&lt;/strong&gt;. So, all of your VM based on that image are deployed with a 128 Gbyte disk - even a “Golden Master” - typically used to build Azure Windows Virtual Desktop images. A clean Windows installation has a size of less than 40 Gbyte, and a &lt;strong&gt;64 Gbyte&lt;/strong&gt; OS disk is usually sufficient - even if FSLogix is used to store personal data.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;But what are the advantages of smaller disks? First, they are some reason to use smaller disks, like:
A smaller disk costs less. Usually 50% less and with the same performance for HDD and standard SSD (the premium disk has more IOPS for the larger size)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Ephemeral disks for smaller VM sizes: Ephemeral disks are really good for VM without local user data - like session hosts using FSLogix. VMs with ephemeral disks living on the Azure hypervisor without a network-attached disk - the OS disks are created directly in the cache of the hypervisor.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Advantages:
No costs for the disk and high performance.
Unfortunately, the cache size is limited based on the VM size. To run a 128 Gbyte Windows, (e.g.) a D8ds_v4 (8 cores, 32 Gbyte RAM, 200 GiB cache) is needed. That is maybe not attractive for a single user session host. If we go with a 64 Gbyte disk image, a D4ds_v4 can be used (4 cores, 16 Gbyte, 100GiB cache), which costs half.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;My favorite is the ephemeral disk approach for some environments because this offers high performance for a low price and often fits Windows Virtual Desktop.&lt;/p&gt;
&lt;h2 id=&quot;the-challenge&quot;&gt;The challenge&lt;/h2&gt;
&lt;p&gt;The challenge is to resize the Golden Master. There are some good posts about doing that, but it’s not easy and needs many different steps. Therefore, I added this as a feature in WVDAdmin from the release of today. So feel free to resize your Golden Master to 64 Gbyte, grab an image and deploy smaller session hosts - may be as ephemeral with &lt;a href=&quot;https://blog.itprocloud.de/Windows-Virtual-Desktop-Admin&quot;&gt;#WVDAdmin / #AVDAdmin&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I recommend making a snapshot first and keep in mind that the process takes a while (between 20 and 60 minutes). But you only have to do it once.&lt;/p&gt;
&lt;p&gt;What happens in the background:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The Windows partition will be resized to 31 Gbyte&lt;/li&gt;
&lt;li&gt;The disk is uploaded to a temporary created storage account (that takes a while)&lt;/li&gt;
&lt;li&gt;The disk is resized, and the signature for a 32 Gbyte disk is written&lt;/li&gt;
&lt;li&gt;A new 32 Gbyte managed disk is created&lt;/li&gt;
&lt;li&gt;The disk is attached to the VM&lt;/li&gt;
&lt;li&gt;The temporary storage account is deleted&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;site-node-how-to-use-ephemeral-vms-in-a-very-cool-way&quot;&gt;Site node: How to use ephemeral VMs in a very cool way?&lt;/h2&gt;
&lt;p&gt;I’m currently working on the following solution called “Project Hydra” to managed WVD. In addition, I added an “Autoscale” feature that is going hand-in-hand with Microsoft’s “Power-on-Connect”:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;In the morning, a bunch of ephemeral session hosts are automatically created to handle the first user storm&lt;/li&gt;
&lt;li&gt;Some stand-by session hosts (deallocated) with standard SSD are then started with Power-On-Connect if a user tries to log in, and all of the ephemeral hosts are in use&lt;/li&gt;
&lt;li&gt;And for sure: Deallocation of the “normal” hosts and deletion of the ephemeral hosts are part of the autoscaling&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;preqersits-to-shrink-a-disk&quot;&gt;Preqersits to shrink a disk:&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Windows operating system installed on a 128 Gbyte disk or greater&lt;/li&gt;
&lt;li&gt;Only drive C: (exact two partitions: recovery partition and C-drive - default)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Check out the newest version of &lt;a href=&quot;https://blog.itprocloud.de/Windows-Virtual-Desktop-Admin&quot;&gt;#WVDAdmin / #AVDAdmin&lt;/a&gt; and check a short demo video about resizing a disk on &lt;a href=&quot;https://youtu.be/Qb9CRHytXv0&quot;&gt;YouTube (external Link)&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/WVDAdmin-Shrink-01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 18 May 2021 00:00:00 +0200</pubDate>
        <link>https://blog.itprocloud.de/WVD-Shrink-the-OS-Disk-in-Azure-to-64-Gbyte/</link>
        <guid isPermaLink="true">https://blog.itprocloud.de/WVD-Shrink-the-OS-Disk-in-Azure-to-64-Gbyte/</guid>
        
        
        <category>Windows Virtual Desktop</category>
        
        <category>Azure Virtual Desktop</category>
        
      </item>
    
      <item>
        <title>Azure Windows Virtual Desktop Fileupload with the HTML5 client</title>
        <description>&lt;p&gt;Microsoft is extending the HTML5 web client. Today (May 2021), there is a new function to allow uploading files directly into the session. The user can select the feature while starting a connection. Inside the HTML5 client, the user can upload a file with the icon in the upper right corner. The file is saved into the virtual drive: &lt;em&gt;\\tsclient\Remote Desktop Virtual Drive\Uploads&lt;/em&gt; (the drive only exist in the current session)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/FileUpload01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;An administrator can avoid storing files into the virtual drive setting the group policy (per user or per machine) to “Enabled”:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session\Device and Resource\Do not allow drive redirection
&lt;/code&gt;&lt;/pre&gt;</description>
        <pubDate>Tue, 04 May 2021 00:00:00 +0200</pubDate>
        <link>https://blog.itprocloud.de/WVD-Fileupload-HTML5/</link>
        <guid isPermaLink="true">https://blog.itprocloud.de/WVD-Fileupload-HTML5/</guid>
        
        
        <category>Windows Virtual Desktop</category>
        
        <category>Azure Virtual Desktop</category>
        
      </item>
    
      <item>
        <title>Changing the disk type automatically while starting or deallocating a session host / VM for WVD</title>
        <description>&lt;p&gt;The costs of running virtual machines in Azure summarize the costs of their components like VM type (compute), storage, network, and some other parts. While the spendings for the compute stops after deallocating VMs, Microsoft continues charging for the storage (the virtual disks). These make sense while the disks continue using the underlying storage.&lt;/p&gt;
&lt;p&gt;There are three main types of storage for managed disks with different prices: E.g 128 GByte costs between $5.89 to $19.71 per disk per month.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/VMTag-WVD.AdvDiskType-02.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;If you have many VMs, the disks’ costs become more important while you have to pay for the disk while the VM is running or not.&lt;/p&gt;
&lt;p&gt;If you run Windows Virtual Desktops, your session hosts don’t run 24/7 (the same happens for test and demo environments). So, you start and stop the virtual machines to your needs. This lowers the compute costs, but the costs for the disks continue. But if a virtual machine is deallocated, the storage performance is unimportant. Why don’t we change the disk type to the cheapest after deallocating and bringing it back to a higher performance before starting the VM? That is absolutely possible and can be done through the Azure Portal - or using WVDAdmin.&lt;/p&gt;
&lt;p&gt;With the current version of WVDAdmin you can tag a VM / session host to change the disk type on start and after the deallocation. Simply add a tag to the VMs with the name “&lt;em&gt;WVD.AdvDiskType&lt;/em&gt;” and one of the following values:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;StandardSSD_LRS&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Premium_LRS&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;After this, refresh WVDAdmin, and the disk type changes on start to the named type and goes to standard HDD (the cheapest) after the deallocation.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/VMTag-WVD.AdvDiskType-01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;PS: You can add the tags automatically using the “Custom Tags” tab in WVDAdmin:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/VMTag-WVD.AdvDiskType-04.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../assets/images/VMTag-WVD.AdvDiskType-03.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Important:&lt;/strong&gt; Keep in mind that change the disk type on the fly only works in WVDAdmin. If you start/stop a VM in the Azure Portal (or with an autoscaling engine), the disk type will not change.&lt;/p&gt;
</description>
        <pubDate>Sat, 27 Feb 2021 00:00:00 +0100</pubDate>
        <link>https://blog.itprocloud.de/Changing-the-disk-type-automatically-while-starting-or-deallocating-a-session-host,-VM-for-WVD/</link>
        <guid isPermaLink="true">https://blog.itprocloud.de/Changing-the-disk-type-automatically-while-starting-or-deallocating-a-session-host,-VM-for-WVD/</guid>
        
        
        <category>Windows Virtual Desktop</category>
        
        <category>Azure Virtual Desktop</category>
        
      </item>
    
  </channel>
</rss>
